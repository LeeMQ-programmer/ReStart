<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.start.pro.User">


	<!-- 회원 정보 전체 조회 -->
	<select id="searchUser">
		SELECT USER_SEQ,USER_EMAIL ,USER_NAME
			   ,USER_NICKNAME ,USER_GRADE ,USER_TYPE
			   ,USER_ADCHK ,USER_TCHK,USER_REGDATE
		FROM USER
		<if test="seq != null">
			WHERE USER_SEQ =#{user_seq}
		</if>
	</select>
<!-- 	강사인증을 한 회원 등급 변경 -->
	<update id="updateTeacher">
		UPDATE USER SET USER_GRADE ='T' ,USER_TCHK='Y'
		WHERE USER_SEQ =#{user_seq} AND USER_TCHK='N'
	</update>
	
<!-- 	회원 유형 휴면으로 변경 -->
	<update id="updateHuman">
	UPDATE USER SET USER_TYPE ='H'
	WHERE (TRUNC(SYSDATE)-(SELECT LAST_LOGIN 
							FROM USER_LOG 
							WHERE USER_SEQ =#{user_seq}))>'365'
	</update>

<!-- 	비밀번호 수정 -->
	<update id="updatePw">
		UPDATE USER SET USER_PW=#{user_pw} WHERE USER_SEQ =#{user_seq}
	</update>
	
<!-- 	닉네임 수정 -->
	<update id="updateNn">
		UPDATE USER SET USER_NICKNAME=#{user_nickname} WHERE USER_SEQ =#{user_seq}
	</update>
	
<!-- 	전화번호 수정 -->
	<update id="updatePhone">
		UPDATE USER SET USER_PHONE=#{user_phone} WHERE USER_SEQ =#{user_seq}
	</update>
	
<!-- 	광고수신 동의 여부 수정-->
	<update id="updateAdChk">
		UPDATE USER SET
		<if test="user_adchk == N">
		USER_ADCHK ='Y' WHERE USER_SEQ =#{user_seq} AND USER_ADCHK ='N'
		</if>
		<if test="user_adchk == Y">
		USER_ADCHK ='N' WHERE USER_SEQ =#{user_seq} AND USER_ADCHK ='Y'
		</if>
	</update>
	
	<update id="updateGrade">
		UPDATE USER SET 
		<if test="user_grade == M">
			USER_GRADE ='T'	
		</if>
		WHERE USER_GRADE='M' AND USER_SEQ =4 AND USER_TCHK ='Y'
	</update>

	
	
	

</mapper>


















