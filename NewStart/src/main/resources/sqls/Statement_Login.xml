<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.start.pro.login">

<!-- 로그인 -->

<!-- 아이디를 통해 비밀번호와 권한 가져온다  -->
<!-- SELECT USER_PW, USER_GRADE FROM "USER" u
 WHERE USER_EMAIL = '' -->

<!-- 
회원번호를 통해 회원 유형을 가져온다.
SELECT USER_TYPE FROM "USER" u
 WHERE USER_SEQ  = ''
 -->
 
 <!-- 
 회원번호 통해 유저 정보 가져온다 (세션에 담기 위해)
SELECT USER_EMAIL, USER_NICKNAME, USER_NAME, 
  USER_GRADE, USER_TYPE, USER_PHONE 
   FROM "USER" u
    WHERE USER_SEQ  = ''
 -->

<!-- 
회원번호 통해 비밀번호 틀린 횟수 초기화
UPDATE USER_LOG SET PW_FAIL_CHK = 0 
 WHERE USER_SEQ  = ''
 -->
 
 
 <!-- 
 마지막 로그인 날짜 수정하기
 UPDATE USER_LOG SET LAST_LOGIN = SYSDATE
 WHERE USER_SEQ  = ''
  -->
 
 <!-- 
 휴면회원을 일반회원으로 등급 변경
 UPDATE "USER" SET USER_TYPE = 'N'
  WHERE USER_SEQ  = ''
  -->
 
 
 <!-- 
  비밀번호 틀린 횟수 +1해주기
  UPDATE USER_LOG SET PW_FAIL_CHK  = PW_FAIL_CHK+1
  WHERE USER_SEQ  = ''
  -->
 
 
 <!-- 
 비밀번호 틀린 횟수 가져오기
 SELECT PW_FAIL_CHK 
 FROM USER_LOG ul
  WHERE USER_SEQ = ''
  -->
  
  
  <!-- 회원정보 -->
  
 <!-- 
 아이디 중복검사
 SELECT COUNT(*) FROM "USER" u 
 WHERE USER_EMAIL = ''
  -->
  
 <!-- 
 닉네임 중복 검사
 SELECT COUNT(*) FROM "USER" u 
 WHERE USER_NICKNAME = ''
  -->
  
 <!-- 
 유저정보 넣기 / 권한은 잠금
 INSERT INTO "USER"
(USER_SEQ, USER_EMAIL, USER_NICKNAME, USER_NAME, USER_GRADE, USER_TYPE, USER_PW, USER_PHONE, USER_ADCHK, USER_REGDATE,USER_TCHK )
VALUES(USER_SEQS.NEXTVAL , 'ckadl0118@naver.com', '루삥뽕', '김참이', 'M', 'L', '1234', '010-8992-2455', 'Y', SYSDATE, 'N')
  -->
 
 
<!-- 
유저로그에 정보 넣기
INSERT INTO USER_LOG
(USER_SEQ, LAST_LOGIN, PW_UPDATE_DATE, PW_FAIL_CHK)
VALUES(0, NULL, NULL, 0)
 -->
 
<!-- 
유저 권한 일반 유저로 변환
(이메일 인증 성공시)
UPDATE "USER" SET USER_TYPE = 'N' WHERE USER_SEQ = ''
 -->
 
 <!-- 아이디 찾기 -->
 
 
 <!-- 
 휴대폰 번호로 아이디 가져오기
 SELECT USER_EMAIL FROM "USER" u
 WHERE USER_PHONE = ''
  -->

<!-- 비밀번호 찾기 -->

<!-- 
이메일로 임시 비밀번호로 업데이트하기
UPDATE "USER" SET USER_PW = '1234' 
 WHERE USER_EMAIL = ''
 -->
 
 <!-- 
 마지막 비밀번호 변경일 수정
 UPDATE USER_LOG SET PW_UPDATE_DATE = SYSDATE
 WHERE USER_SEQ = ''
  -->

</mapper>
